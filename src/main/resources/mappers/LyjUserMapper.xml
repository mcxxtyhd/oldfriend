<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="com.feng.oldfriend.dao.LyjUserMapper" >
  <resultMap id="BaseResultMap" type="com.feng.oldfriend.entity.LyjUser" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
    -->
    <id column="lyj_user_id" property="lyjUserId" jdbcType="INTEGER" />
    <result column="lyj_user_openid" property="lyjUserOpenid" jdbcType="VARCHAR" />
    <result column="lyj_user_name" property="lyjUserName" jdbcType="VARCHAR" />
    <result column="lyj_user_gender" property="lyjUserGender" jdbcType="INTEGER" />
    <result column="lyj_user_location" property="lyjUserLocation" jdbcType="VARCHAR" />
    <result column="lyj_user_age" property="lyjUserAge" jdbcType="INTEGER" />
    <result column="lyj_user_country" property="lyjUserCountry" jdbcType="VARCHAR" />
    <result column="lyj_user_creditid" property="lyjUserCreditid" jdbcType="VARCHAR" />
    <result column="lyj_user_phone" property="lyjUserPhone" jdbcType="VARCHAR" />
    <result column="lyj_user_livingplace" property="lyjUserLivingplace" jdbcType="VARCHAR" />
    <result column="lyj_user_workplace" property="lyjUserWorkplace" jdbcType="VARCHAR" />
    <result column="lyj_user_creditpositive" property="lyjUserCreditpositive" jdbcType="VARCHAR" />
    <result column="lyj_user_creditnegative" property="lyjUserCreditnegative" jdbcType="VARCHAR" />
    <result column="lyj_user_rewards" property="lyjUserRewards" jdbcType="INTEGER" />
    <result column="lyj_user_birthday" property="lyjUserBirthday" jdbcType="TIMESTAMP" />
    <result column="lyj_user_password" property="lyjUserPassword" jdbcType="VARCHAR" />
    <result column="lyj_user_uuid" property="lyjUserUuid" jdbcType="VARCHAR" />

    <result column="lyj_volunteer_id" property="lyjVolunteerId" jdbcType="INTEGER" />


  </resultMap>
  <delete id="deleteByPrimaryKey" parameterType="java.lang.Integer" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
    -->
    delete from lyj_user
    where lyj_user_id = #{lyjUserId,jdbcType=INTEGER}
  </delete>
  <insert id="insert" parameterType="com.feng.oldfriend.entity.LyjUser" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
    -->
    insert into lyj_user (lyj_user_id, lyj_user_openid, lyj_user_name,
      lyj_user_gender, lyj_user_location, lyj_user_age,
      lyj_user_country, lyj_user_creditid, lyj_user_phone,
      lyj_user_livingplace, lyj_user_workplace, lyj_user_creditpositive,
      lyj_user_creditnegative,lyj_user_rewards,lyj_user_birthday,lyj_user_password,lyj_user_uuid)
    values (#{lyjUserId,jdbcType=INTEGER}, #{lyjUserOpenid,jdbcType=VARCHAR}, #{lyjUserName,jdbcType=VARCHAR},
      #{lyjUserGender,jdbcType=INTEGER}, #{lyjUserLocation,jdbcType=VARCHAR}, #{lyjUserAge,jdbcType=INTEGER},
      #{lyjUserCountry,jdbcType=VARCHAR}, #{lyjUserCreditid,jdbcType=VARCHAR}, #{lyjUserPhone,jdbcType=VARCHAR},
      #{lyjUserLivingplace,jdbcType=VARCHAR}, #{lyjUserWorkplace,jdbcType=VARCHAR}, #{lyjUserCreditpositive,jdbcType=VARCHAR},
      #{lyjUserCreditnegative,jdbcType=VARCHAR},#{lyjUserRewards,jdbcType=INTEGER},#{lyjUserBirthday,jdbcType=DATE},
      #{lyjUserPassword,jdbcType=VARCHAR}, #{lyjUserUuid,jdbcType=VARCHAR}
      )
  </insert>
  <update id="updateByPrimaryKey" parameterType="com.feng.oldfriend.entity.LyjUser" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
    -->
    update lyj_user
    set lyj_user_openid = #{lyjUserOpenid,jdbcType=VARCHAR},
      lyj_user_name = #{lyjUserName,jdbcType=VARCHAR},
      lyj_user_gender = #{lyjUserGender,jdbcType=INTEGER},
      lyj_user_location = #{lyjUserLocation,jdbcType=VARCHAR},
      lyj_user_age = #{lyjUserAge,jdbcType=INTEGER},
      lyj_user_country = #{lyjUserCountry,jdbcType=VARCHAR},
      lyj_user_creditid = #{lyjUserCreditid,jdbcType=VARCHAR},
      lyj_user_phone = #{lyjUserPhone,jdbcType=VARCHAR},
      lyj_user_livingplace = #{lyjUserLivingplace,jdbcType=VARCHAR},
      lyj_user_workplace = #{lyjUserWorkplace,jdbcType=VARCHAR},
      lyj_user_creditpositive = #{lyjUserCreditpositive,jdbcType=VARCHAR},
      lyj_user_creditnegative = #{lyjUserCreditnegative,jdbcType=VARCHAR},
      lyj_user_rewards = #{lyjUserRewards,jdbcType=INTEGER},
      lyj_user_birthday = #{lyjUserBirthday,jdbcType=INTEGER},
      lyj_user_password = #{lyjUserPassword,jdbcType=VARCHAR},
      lyj_user_uuid = #{lyjUserUuid,jdbcType=VARCHAR}
    where lyj_user_id = #{lyjUserId,jdbcType=DATE}
  </update>

  <update id="updateByPrimaryKeyForVolunteer" parameterType="com.feng.oldfriend.entity.LyjUser" >
    update lyj_user
    set
    lyj_user_name = #{lyjUserName,jdbcType=VARCHAR},
    lyj_user_gender = #{lyjUserGender,jdbcType=INTEGER},
    lyj_user_location = #{lyjUserLocation,jdbcType=VARCHAR},
    lyj_user_age = #{lyjUserAge,jdbcType=INTEGER},
    lyj_user_country = #{lyjUserCountry,jdbcType=VARCHAR},
    lyj_user_creditid = #{lyjUserCreditid,jdbcType=VARCHAR},
    lyj_user_livingplace = #{lyjUserLivingplace,jdbcType=VARCHAR},
    lyj_user_workplace = #{lyjUserWorkplace,jdbcType=VARCHAR},
    lyj_user_creditpositive = #{lyjUserCreditpositive,jdbcType=VARCHAR},
    lyj_user_creditnegative = #{lyjUserCreditnegative,jdbcType=VARCHAR},
    lyj_user_rewards = #{lyjUserRewards,jdbcType=INTEGER},
    lyj_user_birthday = #{lyjUserBirthday,jdbcType=INTEGER}
    where lyj_user_id = #{lyjUserId,jdbcType=DATE}
  </update>


  <select id="selectByPrimaryKey" resultMap="BaseResultMap" parameterType="java.lang.Integer" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
    -->
    select a.lyj_user_id, a.lyj_user_openid, a.lyj_user_name, a.lyj_user_gender, a.lyj_user_location,
    a.lyj_user_age, a.lyj_user_country, a.lyj_user_creditid, a.lyj_user_phone, a.lyj_user_livingplace,
    a.lyj_user_workplace, a.lyj_user_creditpositive, a.lyj_user_creditnegative,a.lyj_user_rewards,
    a.lyj_user_birthday,a.lyj_user_password,a.lyj_user_uuid,b.lyj_volunteer_id
    from lyj_user a
    LEFT JOIN lyj_volunteer b ON a.lyj_user_id = b.lyj_user_id
    where a.lyj_user_id = #{lyjUserId,jdbcType=INTEGER}

  </select>

  <!--用户登录验证-->
  <select id="userLogin" resultMap="BaseResultMap">
    select a.*,
    b.lyj_volunteer_id
    from lyj_user a
    LEFT JOIN lyj_volunteer b ON a.lyj_user_uuid = b.lyj_user_id
    where a.lyj_user_phone = #{phone,jdbcType=VARCHAR} and a.lyj_user_password = #{password,jdbcType=VARCHAR}

  </select>

  <!--根据唯一标识找到用户-->
  <select id="findUserByUUID" resultMap="BaseResultMap">
    select *,
    b.lyj_volunteer_id
    from lyj_user a
    LEFT JOIN lyj_volunteer b ON a.lyj_user_id = b.lyj_user_id
    where a.lyj_user_uuid = #{uuid,jdbcType=VARCHAR}

  </select>

  <!--根据手机号码找到用户-->
  <select id="findUserByPhone" resultType="java.lang.Integer">
    select count(1)
    from lyj_user
    where lyj_user_phone = #{phone,jdbcType=VARCHAR}
  </select>


  <select id="selectAll" resultMap="BaseResultMap" >
    <!--
      select lyj_user_id, lyj_user_openid, lyj_user_name, lyj_user_gender, lyj_user_location,
    lyj_user_age, lyj_user_country, lyj_user_creditid, lyj_user_phone, lyj_user_livingplace,
    lyj_user_workplace, lyj_user_creditpositive, lyj_user_creditnegative,lyj_user_rewards
    from lyj_user
    -->
    SELECT
    a.lyj_user_id,
    a.lyj_user_openid,
    a.lyj_user_name,
    a.lyj_user_gender,
    a.lyj_user_location,
    a.lyj_user_age,
    a.lyj_user_country,
    a.lyj_user_creditid,
    a.lyj_user_phone,
    a.lyj_user_livingplace,
    a.lyj_user_workplace,
    a.lyj_user_creditpositive,
    a.lyj_user_creditnegative,
    a.lyj_user_rewards ,
    a.lyj_user_birthday,
    a.lyj_user_password,
    a.lyj_user_uuid,
    b.lyj_volunteer_id
    FROM
    lyj_user a
    LEFT JOIN lyj_volunteer b ON a.lyj_user_id = b.lyj_user_id

  </select>

  <!--根据搜索条件对所有的用户进行查找-->
  <select id="getUsers" resultType="com.feng.oldfriend.entity.LyjUser" >
    <!--<bind name="pattern" value="'%' + searchText + '%'"/>-->

    <choose>
      <when test="searchText">
        <bind name="pattern" value="'%'+ searchText+'%'"/>
      </when>
      <otherwise>
        <bind name="pattern" value="'%%'"/>
      </otherwise>
    </choose>
    SELECT
    a.lyj_user_id as lyjUserId,
    a.lyj_user_openid as lyjUserOpenid,
    a.lyj_user_name as lyjUserName,
    a.lyj_user_gender as lyjUserGender,
    a.lyj_user_location as lyjUserLocation,
    a.lyj_user_age as lyjUserAge,
    a.lyj_user_country as lyjUserCountry,
    a.lyj_user_creditid as lyjUserCreditid,
    a.lyj_user_phone as lyjUserPhone,
    a.lyj_user_livingplace as lyjUserLivingplace,
    a.lyj_user_workplace as lyjUserWorkplace,
    a.lyj_user_creditpositive as lyjUserCreditpositive,
    a.lyj_user_creditnegative as lyjUserCreditnegative,
    a.lyj_user_rewards as lyjUserRewards,
    a.lyj_user_password as lyjUserPassword,
    a.lyj_user_uuid as lyjUserUuid,
    a.lyj_user_birthday as lyjUserBirthday,
    b.lyj_volunteer_id as lyjVolunteerId
    from lyj_user a
    LEFT JOIN lyj_volunteer b ON a.lyj_user_id = b.lyj_user_id
    <if test="searchText!=null and searchText!=''">
      where lyj_user_name like #{pattern}
      or lyj_user_location like #{pattern}
      or lyj_user_country like #{pattern}
      or lyj_user_phone like #{pattern}
      or lyj_user_livingplace like #{pattern}
      or lyj_user_workplace like #{pattern}
    </if>
  </select>

  <select id="getUsersCount" resultType="com.feng.oldfriend.entity.LyjUser" >
    <!--<bind name="pattern" value="'%' + searchText + '%'"/>-->

    <choose>
      <when test="searchText">
        <bind name="pattern" value="'%'+ searchText+'%'"/>
      </when>
      <otherwise>
        <bind name="pattern" value="'%%'"/>
      </otherwise>
    </choose>
    SELECT
    count(1)
    from lyj_user a
    LEFT JOIN lyj_volunteer b ON a.lyj_user_id = b.lyj_user_id
    <if test="searchText!=null and searchText!=''">
      where lyj_user_name like #{pattern}
      or lyj_user_location like #{pattern}
      or lyj_user_country like #{pattern}
      or lyj_user_phone like #{pattern}
      or lyj_user_livingplace like #{pattern}
      or lyj_user_workplace like #{pattern}
    </if>
  </select>
</mapper>
