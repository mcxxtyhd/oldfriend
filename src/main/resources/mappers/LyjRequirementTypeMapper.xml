<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.feng.oldfriend.dao.LyjRequirementTypeMapper">
  <resultMap id="BaseResultMap" type="com.feng.oldfriend.entity.LyjRequirementType">
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
    -->
    <id column="lyj_requirement_typeid" jdbcType="INTEGER" property="lyjRequirementTypeid" />
    <result column="lyj_requirement_typename" jdbcType="VARCHAR" property="lyjRequirementTypename" />
    <result column="lyj_requirement_typeparentid" jdbcType="INTEGER" property="lyjRequirementTypeparentid" />
  </resultMap>
  <delete id="deleteByPrimaryKey" parameterType="java.lang.Integer">
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
    -->
    delete from lyj_requirement_type
    where lyj_requirement_typeid = #{lyjRequirementTypeid,jdbcType=INTEGER}
  </delete>
  <insert id="insert" parameterType="com.feng.oldfriend.entity.LyjRequirementType">
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
    -->
    insert into lyj_requirement_type (lyj_requirement_typeid, lyj_requirement_typename,
      lyj_requirement_typeparentid)
    values (#{lyjRequirementTypeid,jdbcType=INTEGER}, #{lyjRequirementTypename,jdbcType=VARCHAR},
      #{lyjRequirementTypeparentid,jdbcType=INTEGER})
  </insert>
  <update id="updateByPrimaryKey" parameterType="com.feng.oldfriend.entity.LyjRequirementType">
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
    -->
    update lyj_requirement_type
    set lyj_requirement_typename = #{lyjRequirementTypename,jdbcType=VARCHAR},
      lyj_requirement_typeparentid = #{lyjRequirementTypeparentid,jdbcType=INTEGER}
    where lyj_requirement_typeid = #{lyjRequirementTypeid,jdbcType=INTEGER}
  </update>
  <select id="selectByPrimaryKey" parameterType="java.lang.Integer" resultMap="BaseResultMap">
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
    -->
    select lyj_requirement_typeid, lyj_requirement_typename, lyj_requirement_typeparentid
    from lyj_requirement_type
    where lyj_requirement_typeid = #{lyjRequirementTypeid,jdbcType=INTEGER}
  </select>
  <select id="selectAll" resultMap="BaseResultMap">

    <bind name="pattern" value="'%' + searchText + '%'"/>

    select lyj_requirement_typeid, lyj_requirement_typename, lyj_requirement_typeparentid
    from lyj_requirement_type
    <if test=" searchText!=null and searchText!='' ">
      where lyj_requirement_typename like #{pattern}
    </if>
  </select>
  <select id="selectAllCount" resultType="java.lang.Integer">

    <bind name="pattern" value="'%' + searchText + '%'"/>

    select count(1)
    from lyj_requirement_type
    <if test=" searchText!=null and searchText!='' ">
      where lyj_requirement_typename like #{pattern}
    </if>
  </select>

  <select id="getSonRequirementTypes" resultMap="BaseResultMap" parameterType="java.lang.Integer">
    select lyj_requirement_typeid, lyj_requirement_typename, lyj_requirement_typeparentid
    from lyj_requirement_type
    <if test="parentID!=null and parentID!=0">
      where lyj_requirement_typeparentid=#{parentID,jdbcType=INTEGER}
    </if>
    <if test="parentID==null or parentID==0">
      where lyj_requirement_typeparentid is null
    </if>
  </select>

  <select id="getRequirementTypeByStatus" resultMap="BaseResultMap" parameterType="java.lang.Integer">
    SELECT
    lyj_requirement_type.lyj_requirement_typeid,
    lyj_requirement_type.lyj_requirement_typename
    FROM
    lyj_requirementtype_relation
    left join lyj_requirement on lyj_requirementtype_relation.lyj_requirement_id=lyj_requirement.lyj_requirement_id
    left join lyj_requirement_type on lyj_requirementtype_relation.lyj_requirement_typeid=lyj_requirement_type.lyj_requirement_typeid
    <if test="state!=null and state!=0">
      where lyj_requirement.lyj_requirement_state=#{state}
    </if>
    group by lyj_requirement_type.lyj_requirement_typeid,
    lyj_requirement_type.lyj_requirement_typename
  </select>
</mapper>
